import csv
import os

filein = "input.csv"

months = []
changes_pNl =[]
net_pNl = 0
avg_change = 0
counter_month = 0

grt_loss_month = 0
grt_profit_month = 0
current_month_pNl = 0
previous_month_pNl = 0
grt_loss = 0
grt_profit = 0

with open(filein, 'r') as input_data:
    read = csv.reader(input_data, delimiter= ',')
    header = next(read)
    
    for rows in read:
        months.append(rows[0])
     
        net_pNl += int(rows[1])
        
        counter_month  += 1  
        
        current_month_pNl = int(rows[1])
       
        if(counter_month == 1) :
            previous_month_pNl = current_month_pNl
            continue
        else :
            change = current_month_pNl - previous_month_pNl
            previous_month_pNl = current_month_pNl
            
            changes_pNl.append(change)
            
        avg_change = round(sum(changes_pNl)/(counter_month-1),2)
        
        grt_profit = max(changes_pNl)
  
        grt_profit_month = months[changes_pNl.index(grt_profit)+1]
   
        grt_loss = min(changes_pNl)
  
        grt_loss_month = months[changes_pNl.index(grt_loss)+1]
   
    
        

print("Financial Analysis")     
print("-------------------------------------------------------")      
print(f"Total Months : {counter_month}")
print (f"Total Profit : ${net_pNl}")
print(f"Average Change : {avg_change}")
print(f"Best Month : {grt_profit_month} (${grt_profit})")
print(f"Worst Month : {grt_loss_month} (${grt_loss})")

fileout = "Analysis.csv"

with open (fileout, 'w') as output_data :
    writer = csv.writer(output_data)
    
    writer.writerow (["Financial Analysis "])
    writer.writerow (["-------------------------------------------------------"])      
    writer.writerow ([f"Total Months : {counter_month}"])
    writer.writerow ([f"Total Profit : ${net_pNl}"])
    writer.writerow ([f"Average Change : {avg_change}"])
    writer.writerow ([f"Best Month : {grt_profit_month} (${grt_profit})"])
    writer.writerow ([f"Worst Month : {grt_loss_month} (${grt_loss})"])

    
'Count the number of obersevations in first column'
'total of profit/losses in second column'
'Average of change in profit/losses as compared to last month'
'Find greatest positive change in amount and show date'
'Find greatest negative change in amount and show date'




"""
for i in range(len(months)):
    
    count_month += 1
    current_month_pNl = pNl[i]
    total_pNl += pNl[i]
    
    if(count_month == 1):
        change = current_month_pNl - previous_month_pNl
        previous_month_pNl=current_month_pNl
    else:
        change = current_month_pNl - previous_month_pNl
    
    
    monthChange.append(change)
    print(f'{months[i]} : {monthChange[i]}')
    
    previous_month_pNl = current_month_pNl
    total_change += monthChange[i]

   
avg_change= total_change/count_month
great_profit= max(monthChange)
great_loss= min(monthChange)

grt_profit_mon = months[monthChange.index(great_profit)]
grt_loss_mon = months[monthChange.index(great_loss)] 
print(f'Best Month : {grt_profit_mon} : {great_profit}')
print(f'Worst : {grt_loss_mon} : {great_loss}') """
